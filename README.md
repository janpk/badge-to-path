# Badge To Path

> Generate a badge and write to path

A badge generator action written in [Kotlin](https://kotlinlang.org/) powered by [Quarkus GitHub Action](https://github.com/quarkiverse/quarkus-github-action). Internally it uses the [Badge4j](https://github.com/silentsoft/badge4j) library to generate the svg badges.

This badge generator started as an experiment of utilizing the [Quarkus]() framework and [Kotlin]() to create GitHub Actions with the least amount of effort and code.

The action was created for the specific usecase of saving the generated badge into a dedicated branch of the target repository. See Example Usage for more details.

## Usage

### Inputs

|Parameter|Mandatory| Default Value | Description                                             |
|---------|---------|------|---------------------------------------------------------|
|`label`|true| :label | The left label of the badge, usually static             |
| `message`|true| :message | The right status of the badge, usually based on results |
|`labelColor`|false| #007ec6 | The color for the label part of the badge               |
|`messageColor`|false| #9f9f9f | The color for the message part of the badge             |
| `path`|true|      | Output image path|
|`github-token`|true|      | Github Token                                            |

### Outputs

No outputs as of now.

## Example Usage

```yaml
uses: janpk/badge-to-path@v1
with:
  label: 'Lines Of Code'
  message: '1.3K'
  labelColor: 'blue'
  messageColor: 'grey'
  path: 'badges/loc.svg'
```
### Incorporating Into a Workflow

```yaml

```

### Creating a dedicated branch for badges

I have found that having a dedicated branch to keep generated badges work the best for me. To create an empty branch 
```bash
git checkout --orphan <branchname>

git rm -rf .
```
That gets rid of all the files tracked by git from the branch. In addition there you might have some files that are not tracked by git that you want to remove since the second command above probably removed the .gitignore file from the branch.

```bash
rm <some lingering file>
rm -Rf <some lingering directory>
```

After this you should probably add a README.md file to the branch to remind anyone who might stop by the purpose of the branch. Then you add the file(s) you want, commit and push

```bash
git add .

git commit -m "commit message"

git push -u origin <branchname>
```
If you want to write generates badges to this branch, you need to check out the branch in your workflow job
```yaml
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Checkout badges branch to a badges directory nested inside first checkout
        uses: actions/checkout@v3
        with:
          ref: badges
          path: badges
```
you can then specify the path in the badge-to-path action like

```yaml
uses: janpk/badge-to-path@v1
with:
  label: 'Lines Of Code'
  message: '1.3K'
  labelColor: 'blue'
  messageColor: 'grey'
  path: 'badges/loc.svg'
```

and then you need to remember adding a commit step to your job like

```yaml
      - name: Commit the badge (if it changed)
        if: github.ref == 'refs/heads/main'
        run: |
          cd badges
          if [[ `git status --porcelain *.svg` ]]; then
            git config --global user.email "test@example.com"
            git config --global user.name "Badge Gen"
            git add *.svg
            git commit -m "Autogenerated badge(s)" --allow-empty
            git push
          fi
```
## Developer Related

When pushing to the `main` branch, the GitHub Action artifact is automatically published to the Maven repository of this GitHub repository.

The `action.yml` descriptor instructs GitHub Actions to run this published artifact using JBang when the action is executed.

## Related Guides

- GitHub Action ([guide](https://quarkiverse.github.io/quarkiverse-docs/quarkus-github-action/dev/index.html)): Develop GitHub Actions in Java with Quarkus
- Kotlin ([guide](https://quarkus.io/guides/kotlin)): Write your services in Kotlin
